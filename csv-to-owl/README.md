# Conversion of CSV to OWL/TTL

The [dfg_instruments_hierarchy](/csv-to-owl/dfg_instruments_hierarchy.csv) is a hierarchical CSV version of the [geraetegruppenschluessel](/geraetegruppenschluessel.xlsx) xlsx file, with 4 columns for class ID, Label, Level (H, Z, E), and Parent ID.  
  
In many cases, several E-level classes (sometimes more than 10) shared the same ID. To differentiate them, a further 3-digits was appended to the end. This offers flexibility/scalability in the case of adding new E-level classes to appropriate clusters.  
  
Parent ID for all H-level classes is http://purl.obolibrary.org/obo/ERO_0000004, the URI for the Instrument class currently used in VIVO. This can be adjusted in the case of a changed Instrument class or another preferred parent class.

**Features of the create_ggs_ontology script**    
  
- CSV Parsing: Reads the [dfg_instruments_hierarchy](/csv-to-owl/dfg_instruments_hierarchy.csv) CSV file containing DFG GGS hierarchy  
- Ontology Generation: Creates an RDF/OWL ontology where each instrument type is represented as an OWL Class (in rdf:Description nodes) according to the 3-level hierarchy  
- Class Hierarchy: Builds class hierarchies based on parent-child relationships defined in the CSV (using IDs and ParentIDs)  
- Assigns German labels (rdfs:label) to each class, based on original [DFG xlsx file](/geraetegruppenschluessel.xlsx)
- Sets parent classes using rdfs:subClassOf, defaulting to owl:Thing if no parent is specified  
- Merges additional metadata and handle information from separate Turtle files (metadata.ttl, handles.ttl)  
- Outputs the combined ontology in both Turtle (.ttl) and RDF/XML (.owl) formats, with timestamped filenames  
- Skips serlializing any CSV rows marked as "auto-added" in the label (these rows were added to ensure that every Einzelgruppe class will be nested under the corresponding Zehnergruppe. Some Einzelgruppen IDs existed in the range not covered by original Zehnergruppen - exa. E5091, where original Zehnergruppen covered ranges 5000-5090, then 5100-5190)  

**Features of the description_to_owl_converter script**  

The [description_to_owl_converter](/csv-to-owl/description_to_owl_converter.py) script post-processes the RDF/XML ontology file generated by create_ggs_ontology.py to convert all rdf:Description elements representing OWL classes into explicit owl:Class elements, for better compatibility with ontology tools and standards.  
  
- Loads and parses the input RDF/XML file using lxml  
- Element Conversion: Finds all rdf:Description elements that have an rdf:type of owl#Class and changes their tag to owl:Class  
- Optionally removes the now-redundant rdf:type child element from each converted node  
- Automatically selects the most recent dfgggs*.owl file in the directory as input  
- Saves the post-processed ontology to a new file with a timestamped name
